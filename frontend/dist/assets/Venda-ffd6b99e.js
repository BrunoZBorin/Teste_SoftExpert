import{D as g,M as b,a as p}from"./DebouncedCurrencyInput-348e24f6.js";import{_ as y,r as C,o as r,c as i,a as t,F as u,d as m,w as v,v as f,e as I,t as d,p as x,f as D}from"./index-d78af730.js";const P={components:{DebouncedCurrencyInput:g},data(){return{colunas:["Código","Descrição","Valor"],colunasItens:["Cód.","Descrição","Valor","Qtd.","V. Total","Imposto",""],produtos:[],produtoSelecionado:{},produto:{id_produto:"",descricao:"",valor:"",quantidade:1,imposto:0},itensVenda:[],modalProdutos:null,totalImpostos:0,totalCompra:0,modalVendas:null,colunasVendas:["Código","Data","Imposto","Valor Total"],vendas:[]}},mounted(){this.modalProdutos=new b(document.getElementById("listagemProdutos"),{keyboard:!1}),this.modalVendas=new b(document.getElementById("listagemVendas"),{keyboard:!1})},methods:{cliqueProduto(e,a){var n=document.getElementsByTagName("tr");Array.prototype.forEach.call(n,function(h){h.classList.remove("selected")}),e.target.parentNode.classList.add("selected"),this.produtoSelecionado=a},carregaProdutos(){var e=document.getElementsByTagName("tr");Array.prototype.forEach.call(e,function(a){a.classList.remove("selected")}),this.produtoSelecionado={},p.get("http://localhost:8000/produtos").then(a=>{this.produtos=a.data}).catch(a=>{console.log(a)})},abrirModalProdutos(){var e=document.getElementsByTagName("tr");Array.prototype.forEach.call(e,function(a){a.classList.remove("selected")}),this.produtoSelecionado={},this.carregaProdutos(),this.modalProdutos.show()},abrirModalVendas(){this.carregaVendas(),this.modalVendas.show()},setProduto(){this.produto={id_produto:this.produtoSelecionado.id_produto,descricao:this.produtoSelecionado.descricao,valor:this.produtoSelecionado.valor,quantidade:1,imposto:this.produtoSelecionado.imposto},this.modalProdutos.hide()},validaCamposItem(e,a){let n="";return e>0?a>0||(n="Informe uma quantidade válida."):n="Informe um produto.",n},incluirItem(){let e=this.validaCamposItem(this.produto.id_produto,this.produto.quantidade);if(e!=""){alert(e);return}this.itensVenda.push(this.produto),this.produto={id_produto:"",descricao:"",valor:"",quantidade:1,imposto:0},this.totalizaVenda()},excluirItem(e){let a=[];for(var n in this.itensVenda)e!=n&&a.push(this.itensVenda[n]);this.itensVenda=a,this.totalizaVenda()},totalizaVenda(){let e=0,a=0;this.itensVenda.forEach(n=>{a+=Number(n.quantidade)*Number(n.valor),e+=Number(n.quantidade)*Number(n.valor)*(Number(n.imposto)/100)}),this.totalImpostos=e,this.totalCompra=a+e},formatarValor(e){return Number(e).toLocaleString("pt-br",{maximumFractionDigits:2,minimumFractionDigits:2})},formatarData(e){return e=e.substring(0,10),e.split("-")[2]+"/"+e.split("-")[1]+"/"+e.split("-")[0]},finalizarVenda(){if(!(this.itensVenda.length>0)){alert("Inclua ao menos um item ao pedido.");return}let e={itens:this.itensVenda,imposto_total:this.totalImpostos,valor_total:this.totalCompra};p.post("http://localhost:8000/vendas",e).then(a=>{console.log(a),alert("Venda finalizada com sucesso!"),this.cancelarVenda()}).catch(a=>{console.log(a)})},cancelarVenda(){this.itensVenda=[],this.totalCompra=0,this.totalImpostos=0},carregaVendas(){p.get("http://localhost:8000/vendas").then(e=>{this.vendas=e.data}).catch(e=>{console.log(e)})}}},c=e=>(x("data-v-8a0585e5"),e=e(),D(),e),w={id:"venda"},k={class:"modal fade",id:"listagemProdutos","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"listagemProdutosLabel","aria-hidden":"true"},S={class:"modal-dialog"},q={class:"modal-content"},N=c(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"listagemProdutosLabel"},"Selecione um produto"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),F={class:"modal-body"},T={class:"row"},L={class:"table table-default border"},E={scope:"col"},B=["onClick"],M={class:"modal-footer"},z={class:"modal modal-lg fade",id:"listagemVendas","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"listagemVendasLabel","aria-hidden":"true"},Q={class:"modal-dialog"},A={class:"modal-content"},O=c(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"listagemVendasLabel"},"Vendas"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),U={class:"modal-body"},G={class:"row"},R={class:"table table-default border"},j={scope:"col"},H=c(()=>t("div",{class:"modal-footer"},null,-1)),J=c(()=>t("div",{class:"row"},[t("div",{class:"col-5"},[t("h5",null,"Itens venda")]),t("div",{class:"col-1"}),t("div",{class:"col-6"},[t("h5",null,"Incluir Produto")])],-1)),K={class:"row"},W={id:"containerProdutos",class:"col-5"},X={class:"table border"},Y={scope:"col"},Z=["onClick"],$=c(()=>t("div",{class:"col-1"},null,-1)),tt={class:"col-6"},ot={class:"row"},at={class:"col-2"},et=c(()=>t("label",{for:"inputCodigo"},"Cód.",-1)),st={class:"input-group mb-3"},lt={class:"col-5"},dt=c(()=>t("label",{for:"inputDescricao"},"Descrição",-1)),nt={class:"col-2"},rt=c(()=>t("label",{for:"inputValor"},"Valor",-1)),it=["value"],ct={class:"col-2"},ut=c(()=>t("label",{for:"inputQuantidade"},"Qtd.",-1)),mt={class:"col-1"},_t=c(()=>t("label",null,null,-1)),pt=c(()=>t("hr",null,null,-1)),ht={class:"row"},bt={class:"col-6"},vt=c(()=>t("label",{for:"inputTotalImpostos"},"Total Impostos",-1)),ft=["value"],Vt={class:"col-6"},gt=c(()=>t("label",{for:"inputTotalCompra"},"Total Compra",-1)),yt=["value"],Ct={class:"row mt-4"},It={class:"col-12"},xt={class:"row mt-2"},Dt={class:"col-6"},Pt={class:"col-6"};function wt(e,a,n,h,l,s){const V=C("DebouncedCurrencyInput");return r(),i("div",w,[t("div",k,[t("div",S,[t("div",q,[N,t("div",F,[t("div",T,[t("table",L,[t("thead",null,[t("tr",null,[(r(!0),i(u,null,m(l.colunas,o=>(r(),i("th",E,d(o),1))),256))])]),t("tbody",null,[(r(!0),i(u,null,m(l.produtos,o=>(r(),i("tr",{onClick:_=>s.cliqueProduto(_,o)},[t("td",null,d(o.id_produto),1),t("td",null,d(o.descricao),1),t("td",null,d(s.formatarValor(o.valor)),1)],8,B))),256))])])])]),t("div",M,[t("button",{type:"button",onClick:a[0]||(a[0]=(...o)=>s.setProduto&&s.setProduto(...o)),class:"btn btn-success"},"Confirmar")])])])]),t("div",z,[t("div",Q,[t("div",A,[O,t("div",U,[t("div",G,[t("table",R,[t("thead",null,[t("tr",null,[(r(!0),i(u,null,m(l.colunasVendas,o=>(r(),i("th",j,d(o),1))),256))])]),t("tbody",null,[(r(!0),i(u,null,m(l.vendas,o=>(r(),i("tr",null,[t("td",null,d(o.id_venda),1),t("td",null,d(s.formatarData(o.data_venda)),1),t("td",null,d(s.formatarValor(o.imposto_total)),1),t("td",null,d(s.formatarValor(o.valor_total)),1)]))),256))])])])]),H])])]),J,t("div",K,[t("div",W,[t("table",X,[t("thead",null,[t("tr",null,[(r(!0),i(u,null,m(l.colunasItens,o=>(r(),i("th",Y,d(o),1))),256))])]),t("tbody",null,[(r(!0),i(u,null,m(l.itensVenda,(o,_)=>(r(),i("tr",null,[t("td",null,d(o.id_produto),1),t("td",null,d(o.descricao),1),t("td",null,d(s.formatarValor(o.valor)),1),t("td",null,d(s.formatarValor(o.quantidade)),1),t("td",null,d(s.formatarValor(o.quantidade*o.valor)),1),t("td",null,d(s.formatarValor(o.quantidade*o.valor*(o.imposto/100))),1),t("td",{onClick:kt=>s.excluirItem(_),id:"excluirItem",style:{color:"red","font-weight":"bold"}},"x",8,Z)]))),256))])])]),$,t("div",tt,[t("div",ot,[t("div",at,[et,t("div",st,[t("button",{style:{width:"30px",margin:"0px",padding:"4px"},class:"btn btn-primary",type:"button",id:"button-addon1",onClick:a[1]||(a[1]=(...o)=>s.abrirModalProdutos&&s.abrirModalProdutos(...o))},"🔍"),v(t("input",{id:"inputCodigo",type:"text",class:"form-control","aria-describedby":"button-addon1","onUpdate:modelValue":a[2]||(a[2]=o=>l.produto.id_produto=o),disabled:""},null,512),[[f,l.produto.id_produto]])])]),t("div",lt,[dt,v(t("input",{id:"inputDescricao",type:"text",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=o=>l.produto.descricao=o),disabled:""},null,512),[[f,l.produto.descricao]])]),t("div",nt,[rt,t("input",{id:"inputValor",type:"text",class:"form-control",value:s.formatarValor(l.produto.valor),disabled:""},null,8,it)]),t("div",ct,[ut,I(V,{id:"inputQuantidade",class:"form-control",modelValue:l.produto.quantidade,"onUpdate:modelValue":a[4]||(a[4]=o=>l.produto.quantidade=o),value:l.produto.quantidade,options:{currency:"BRL",currencyDisplay:"hidden",valueRange:{max:999999},precision:2,hideCurrencySymbolOnFocus:!1,hideGroupingSeparatorOnFocus:!1,hideNegligibleDecimalDigitsOnFocus:!1,autoDecimalDigits:!0,useGrouping:!0,accountingSign:!1}},null,8,["modelValue","value"])]),t("div",mt,[_t,t("button",{onClick:a[5]||(a[5]=(...o)=>s.incluirItem&&s.incluirItem(...o)),type:"button",class:"btn btn-success"}," ✓ ")])]),pt,t("div",ht,[t("div",bt,[vt,t("input",{id:"inputTotalImpostos",type:"text",class:"form-control",value:s.formatarValor(l.totalImpostos),disabled:""},null,8,ft)]),t("div",Vt,[gt,t("input",{id:"inputTotalCompra",type:"text",class:"form-control",value:s.formatarValor(l.totalCompra),disabled:""},null,8,yt)])]),t("div",Ct,[t("div",It,[t("button",{onClick:a[6]||(a[6]=(...o)=>s.finalizarVenda&&s.finalizarVenda(...o)),type:"button",class:"btn btn-success btn-large"}," Finalizar Venda ")])]),t("div",xt,[t("div",Dt,[t("button",{onClick:a[7]||(a[7]=(...o)=>s.cancelarVenda&&s.cancelarVenda(...o)),type:"button",class:"btn btn-warning text-white btn-large"}," Cancelar Venda ")]),t("div",Pt,[t("button",{onClick:a[8]||(a[8]=(...o)=>s.abrirModalVendas&&s.abrirModalVendas(...o)),type:"button",class:"btn btn-primary btn-large"}," Vendas ")])])])])])}const Nt=y(P,[["render",wt],["__scopeId","data-v-8a0585e5"]]);export{Nt as default};
